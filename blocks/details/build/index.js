(()=>{"use strict";window.wp.i18n;const t=window.wp.blocks;function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function s(t,s,r){return(s=function(t){var s=function(t){if("object"!=e(t)||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var r=s.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(s)?s:s+""}(s))in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}const r=window.React,i=window.wp.element,o=window.wp.blockEditor,n=window.wp.components,a=window.wp.primitives,l=(0,r.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(a.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"}));window.wp.serverSideRender,i.Component,window.wp.compose,i.Component,i.Component;class p extends i.Component{constructor(t){super(t),s(this,"onChangeColor",(t=>{this.props.setAttributes({color:t})})),s(this,"onFormStyleChange",(t=>{this.props.setAttributes({form_style:t})})),s(this,"onSelectPostType",(t=>{this.props.setAttributes({post_type:t,form_scheme:""})})),s(this,"onSelectFormScheme",(t=>{this.props.setAttributes({form_scheme:t})})),s(this,"onCustomizeQuery",((t,e)=>{var s={...this.props.attributes.query};0===e.length?delete s[t]:s[t]=e,this.props.setAttributes({query:s})})),s(this,"getQueryParam",(t=>void 0===this.props.attributes.query[t]?"":this.props.attributes.query[t])),s(this,"getAvailablePostTypes",(()=>{var t=[{label:"",value:""}];return this.state.post_types.forEach((function(e,s){t.push({label:e.label,value:e.post_type})})),t})),s(this,"getCurrentPostType",(()=>this.state.post_types[0])),s(this,"getSelectedFormScheme",(t=>{if(""===this.props.attributes.form_scheme)return null;for(var e=this.getCurrentPostType(),s=0;s<e.form_schemes[t].length;s++)if(e.form_schemes[t][s].name===this.props.attributes.form_scheme)return e.form_schemes[t][s];return null})),s(this,"getSelectedFormSchemeData",(t=>{var e=this.getSelectedFormScheme(t);return null===e?[]:e.data})),s(this,"getAvailableSearchForms",(t=>{var e=this.getCurrentPostType();return[{label:"",value:""}].concat(e.form_schemes.search)})),s(this,"initVisuals",(()=>{const{post_type:t}=this.props.attributes;""!==t&&this.setState({initiated:!0})})),s(this,"resetVisuals",(()=>{this.props.setAttributes({post_type:""}),this.setState({initiated:!1,loading:!0}),this.runApiFetchForms()})),this.state={initiated:!1,post_types:[],loading:!0,show_instructions:!1},this.initVisuals()}componentDidMount(){this.runApiFetchForms()}runApiFetchForms(){wp.apiFetch({path:"wpadverts/v1/classifieds-types"}).then((t=>{this.setState({post_types:t.data,loading:!1,initiated:""!==this.props.attributes.post_type})}))}renderInit(){const{post_type:t}=this.props.attributes,{show_instructions:e}=this.state;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(n.Placeholder,{icon:l,label:"Classifieds Details",instructions:"Select custom post type and search form scheme to continue.",isColumnLayout:"true"},!0===this.state.loading?(0,r.createElement)(n.Spinner,null):(0,r.createElement)(r.Fragment,null,(0,r.createElement)(n.SelectControl,{label:"Custom Post Type",labelPosition:"top",value:t,options:this.getAvailablePostTypes(),onChange:this.onSelectPostType,style:{lineHeight:"1rem"}}),(0,r.createElement)("div",null,(0,r.createElement)(n.Button,{variant:"primary",disabled:""===t,onClick:this.initVisuals},"Apply")))))}render(){const{className:t,attributes:e}=this.props,{}=e,{show_instructions:s}=this.state;return(0,r.createElement)(r.Fragment,null,!0===this.state.initiated?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.BlockControls,null,(0,r.createElement)(n.Toolbar,{controls:[{icon:"controls-repeat",title:"Reset post type and form scheme",onClick:this.resetVisuals}]})),(0,r.createElement)(n.Disabled,null,(0,r.createElement)("div",{className:"wpa-block-editor-common-tip",style:{textAlign:"center"}},(0,r.createElement)("i",{className:"fa-solid fa-eye-slash",style:{fontSize:"64px",padding:"16px",fontStyle:"normal",margin:"16px"}}),(0,r.createElement)("p",{style:{fontSize:"24px"}},"No preview available for this block.")))):(0,r.createElement)(r.Fragment,null,this.renderInit()))}}const c=p,m=JSON.parse('{"name":"wpadverts/details","textdomain":"wpadverts","apiVersion":1,"title":"Classifieds Details","icon":"megaphone","category":"wpadverts","example":{},"attributes":{"post_type":{"type":"string","default":""},"contact":{"type":"array","default":[{"name":"contact-reveal"},{"name":"contact-form"},{"name":"phone-button"}]},"phone_reveal":{"type":"integer","default":1}}}');(0,t.registerBlockType)(m,{edit:c,save:({attributes:t})=>null})})();