(()=>{"use strict";window.wp.i18n;const e=window.wp.blocks;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function a(e,a,l){return(a=function(e){var a=function(e){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,"string");if("object"!=t(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(a)?a:a+""}(a))in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}const l=window.React,i=window.wp.element,s=window.wp.blockEditor,o=window.wp.components,n=window.wp.primitives,r=(0,l.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(n.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"}));window.wp.serverSideRender,i.Component,window.wp.compose,i.Component;class h extends i.Component{constructor(e){super(e),a(this,"togglePopover",(()=>{this.setState({popover:!this.state.popover})})),a(this,"setColor",(e=>{console.log(e),this.setState({color:e.hex})})),a(this,"applyColor",(()=>{this.value=this.state.color,this.setState({popover:!1,color:null}),this.props.onChange(this.value)})),a(this,"cancelColor",(()=>{this.setState({popover:!1,color:null})})),a(this,"resetColor",(()=>{this.value="",this.setState({popover:!1,color:null}),this.props.onChange(this.value)})),this.state={popover:!1,color:null},this.value=this.props.value}render(){const{value:e,label:t,labelPosition:a}=this.props;return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(o.BaseControl,{label:t,labelPosition:"top"},(0,l.createElement)("div",{className:"wpa-color-indicator-wrap"},(0,l.createElement)("span",{className:"wpa-color-indicator",style:{background:this.value}}),(0,l.createElement)(o.Button,{variant:"secondary",isSmall:"true",onClick:this.togglePopover},"Select Color"),(0,l.createElement)(o.Button,{variant:"link",onClick:this.resetColor},"Reset")),!0===this.state.popover&&(0,l.createElement)(o.Popover,null,(0,l.createElement)(o.ColorPicker,{style:{padding:"5px"},color:this.value,onChangeComplete:this.setColor,enableAlpha:!0,defaultValue:"#000"}),(0,l.createElement)("div",{style:{padding:"0px 16px 12px 16px"}},(0,l.createElement)(o.Button,{onClick:this.applyColor,variant:"primary"},"Apply"),"Â ",(0,l.createElement)(o.Button,{onClick:this.cancelColor,variant:"secondary"},"Cancel")))))}}const p=h;class u extends i.Component{constructor(e){super(e),a(this,"onChangeColor",(e=>{this.props.setAttributes({color:e})})),a(this,"onFormStyleChange",(e=>{this.props.setAttributes({form_style:e})})),a(this,"onSelectPostType",(e=>{this.props.setAttributes({post_type:e,form_scheme:""})})),a(this,"onSelectFormScheme",(e=>{this.props.setAttributes({form_scheme:e})})),a(this,"onCustomizeQuery",((e,t)=>{var a={...this.props.attributes.query};0===t.length?delete a[e]:a[e]=t,this.props.setAttributes({query:a})})),a(this,"getQueryParam",(e=>void 0===this.props.attributes.query[e]?"":this.props.attributes.query[e])),a(this,"getAvailablePostTypes",(()=>{var e=[{label:"",value:""}];return this.state.post_types.forEach((function(t,a){e.push({label:t.label,value:t.post_type})})),e})),a(this,"getCurrentPostType",(()=>this.state.post_types[0])),a(this,"getSelectedFormScheme",(e=>{if(""===this.props.attributes.form_scheme)return null;for(var t=this.getCurrentPostType(),a=0;a<t.form_schemes[e].length;a++)if(t.form_schemes[e][a].name===this.props.attributes.form_scheme)return t.form_schemes[e][a];return null})),a(this,"getSelectedFormSchemeData",(e=>{var t=this.getSelectedFormScheme(e);return null===t?[]:t.data})),a(this,"getAvailableSearchForms",(e=>{var t=this.getCurrentPostType();return[{label:"",value:""}].concat(t.form_schemes.search)})),a(this,"initVisuals",(()=>{const{post_type:e}=this.props.attributes;""!==e&&this.setState({initiated:!0})})),a(this,"resetVisuals",(()=>{this.props.setAttributes({post_type:""}),this.setState({initiated:!1,loading:!0}),this.runApiFetchForms()})),a(this,"onChangeGalleryHeight",(e=>{const t=this.getOptionsHeight();this.props.setAttributes({gallery_img_height:t[e].value})})),a(this,"onChangeGalleryImgSize",(e=>{this.props.setAttributes({gallery_img_size:e})})),a(this,"onChangeGalleryFit",(e=>{this.props.setAttributes({gallery_fit:e})})),a(this,"onChangeGalleryBg",(e=>{this.props.setAttributes({gallery_bg:e})})),a(this,"onToggleSliderIsLazy",(e=>{this.props.setAttributes({slider_is_lazy:e})})),a(this,"onToggleNavShow",(e=>{this.props.setAttributes({nav_show:e})})),a(this,"onChangeNavPosition",(e=>{this.props.setAttributes({nav_position:e})})),a(this,"onToggleThumbShow",(e=>{this.props.setAttributes({thumb_show:e})})),a(this,"onChangeThumbHeight",(e=>{const t=this.getOptionsThumbHeight();this.props.setAttributes({thumb_height:t[e].value})})),a(this,"onChangeThumbWidth",(e=>{const t=this.getOptionsThumbWidth();this.props.setAttributes({thumb_width:t[e].value})})),a(this,"onChangeThumbImgSize",(e=>{this.props.setAttributes({thumb_img_size:e})})),a(this,"onChangeThumbFit",(e=>{this.props.setAttributes({thumb_fit:e})})),a(this,"onChangeThumbBg",(e=>{this.props.setAttributes({thumb_bg:e})})),a(this,"getIndex",((e,t)=>{for(let a=0;a<t.length;a++)if(e===t[a].value)return a})),this.state={initiated:!1,post_types:[],loading:!0,show_instructions:!1},this.initVisuals()}componentDidMount(){this.runApiFetchForms()}runApiFetchForms(){wp.apiFetch({path:"wpadverts/v1/classifieds-types"}).then((e=>{this.setState({post_types:e.data,loading:!1,initiated:""!==this.props.attributes.post_type})}))}renderInit(){const{post_type:e,gallery_img_height:t,gallery_img_size:a,gallery_fit:i,gallery_bg:s,slider_is_lazy:n,thumb_show:h,thumb_width:p,thumb_height:u,thumb_img_size:m,thumb_fit:g,thumb_bg:b,nav_show:c,nav_position:w}=this.props.attributes,{show_instructions:v}=this.state;return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(o.Placeholder,{icon:r,label:"Classifieds Single Gallery",instructions:"Select custom post type and search form scheme to continue.",isColumnLayout:"true"},!0===this.state.loading?(0,l.createElement)(o.Spinner,null):(0,l.createElement)(l.Fragment,null,(0,l.createElement)(o.SelectControl,{label:"Custom Post Type",labelPosition:"top",value:e,options:this.getAvailablePostTypes(),onChange:this.onSelectPostType,style:{lineHeight:"1rem"}}),(0,l.createElement)("div",null,(0,l.createElement)(o.Button,{variant:"primary",disabled:""===e,onClick:this.initVisuals},"Apply")))))}getOptionsHeight(){return[{label:"~128px",value:"atw-h-32"},{label:"~144px",value:"atw-h-36"},{label:"~160px",value:"atw-h-40"},{label:"~176px",value:"atw-h-44"},{label:"~192px",value:"atw-h-48"},{label:"~208px",value:"atw-h-52"},{label:"~224px",value:"atw-h-56"},{label:"~240px",value:"atw-h-60"},{label:"~256px",value:"atw-h-64"},{label:"~288px",value:"atw-h-72"},{label:"~320px",value:"atw-h-80"},{label:"~384px",value:"atw-h-96"}]}getOptionsThumbHeight(){return[{label:"~16px",value:"atw-h-4"},{label:"~20px",value:"atw-h-5"},{label:"~24px",value:"atw-h-6"},{label:"~28px",value:"atw-h-7"},{label:"~32px",value:"atw-h-8"},{label:"~36px",value:"atw-h-9"},{label:"~40px",value:"atw-h-10"},{label:"~44px",value:"atw-h-11"},{label:"~48px",value:"atw-h-12"},{label:"~56px",value:"atw-h-14"},{label:"~64px",value:"atw-h-16"},{label:"~80px",value:"atw-h-20"},{label:"~96px",value:"atw-h-24"},{label:"~112px",value:"atw-h-28"},{label:"~128px",value:"atw-h-32"}]}getOptionsThumbWidth(){return[{label:"~16px",value:"atw-w-4"},{label:"~20px",value:"atw-w-5"},{label:"~24px",value:"atw-w-6"},{label:"~28px",value:"atw-w-7"},{label:"~32px",value:"atw-w-8"},{label:"~36px",value:"atw-w-9"},{label:"~40px",value:"atw-w-10"},{label:"~44px",value:"atw-w-11"},{label:"~48px",value:"atw-w-12"},{label:"~56px",value:"atw-w-14"},{label:"~64px",value:"atw-w-16"},{label:"~80px",value:"atw-w-20"},{label:"~96px",value:"atw-w-24"},{label:"~112px",value:"atw-w-28"},{label:"~128px",value:"atw-w-32"}]}getOptionsSize(){return[{value:"adverts-upload-thumbnail",label:"Adverts - Upload Thumbnail"},{value:"adverts-list",label:"Adverts - List"},{value:"adverts-gallery",label:"Adverts - Gallery"},{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"},{value:"full",label:"Full Size"}]}getOptionsFit(){return[{value:"none",label:"Default"},{value:"contain",label:"Contain"},{value:"cover",label:"Cover"},{value:"fill",label:"Fill"},{value:"scale-down",label:"Scale Down"}]}getOptionsNav(){return[{value:"top-left",label:"Top Left"},{value:"top-right",label:"Top Right"},{value:"bottom-left",label:"Bottom Left"},{value:"bottom-right",label:"Bottom Right"}]}printNavPos(e){return{"top-left":"atw-top-0 atw-left-0","top-right":"atw-top-0 atw-right-0","bottom-left":"atw-bottom-0 atw-left-0","bottom-right":"atw-bottom-0 atw-right-0"}[e]}printBackground(e){return e.length>0?{backgroundColor:e}:{}}render(){const{className:e,attributes:t}=this.props,{gallery_img_height:a,gallery_img_size:i,gallery_fit:n,gallery_bg:r,slider_is_lazy:h,thumb_show:u,thumb_width:m,thumb_height:g,thumb_img_size:b,thumb_fit:c,thumb_bg:w,nav_show:v,nav_position:d}=t,{show_instructions:y}=this.state;return(0,l.createElement)(l.Fragment,null,!0===this.state.initiated?(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.InspectorControls,null,(0,l.createElement)(o.PanelBody,{title:"Gallery"},(0,l.createElement)(p,{label:"Gallery Background",labelPosition:"top",value:r,onChange:this.onChangeGalleryBg}),(0,l.createElement)(o.RangeControl,{label:"Image Height",value:this.getIndex(a,this.getOptionsHeight()),onChange:this.onChangeGalleryHeight,min:0,max:this.getOptionsHeight().length-1,withInputField:!1}),(0,l.createElement)(o.SelectControl,{label:"Use Image Size",value:i,options:this.getOptionsSize(),onChange:this.onChangeGalleryImgSize}),(0,l.createElement)(o.SelectControl,{label:"Image Fit",value:n,options:this.getOptionsFit(),onChange:this.onChangeGalleryFit}),(0,l.createElement)(o.ToggleControl,{label:"Lazy load gallery images",checked:h,onChange:this.onToggleSliderIsLazy}),(0,l.createElement)(o.ToggleControl,{label:"Show navigation",checked:v,onChange:this.onToggleNavShow}),v&&(0,l.createElement)(o.SelectControl,{label:"Navigation position",value:d,options:this.getOptionsNav(),onChange:this.onChangeNavPosition})),(0,l.createElement)(o.PanelBody,{title:"Thumbnails"},(0,l.createElement)(o.ToggleControl,{label:"Show thumbnails below gallery",checked:u,onChange:this.onToggleThumbShow}),u&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(p,{label:"Thumbnail Background",labelPosition:"top",value:w,onChange:this.onChangeThumbBg}),(0,l.createElement)(o.RangeControl,{label:"Thumbnail Height",value:this.getIndex(g,this.getOptionsThumbHeight()),onChange:this.onChangeThumbHeight,min:0,max:this.getOptionsThumbHeight().length-1,withInputField:!1}),(0,l.createElement)(o.RangeControl,{label:"Thumbnail Width",value:this.getIndex(m,this.getOptionsThumbWidth()),onChange:this.onChangeThumbWidth,min:0,max:this.getOptionsThumbWidth().length-1,withInputField:!1}),(0,l.createElement)(o.SelectControl,{label:"Use Image Size",value:b,options:this.getOptionsSize(),onChange:this.onChangeThumbImgSize}),(0,l.createElement)(o.SelectControl,{label:"Thumbnail Fit",value:c,options:this.getOptionsFit(),onChange:this.onChangeThumbFit})))),(0,l.createElement)(s.BlockControls,null,(0,l.createElement)(o.Toolbar,{controls:[{icon:"controls-repeat",title:"Reset post type and form scheme",onClick:this.resetVisuals}]})),(0,l.createElement)(o.Disabled,null,(0,l.createElement)("div",{className:"atw-relative",style:{textAlign:"center"}},(0,l.createElement)("div",{className:"atw-bg-gray-100 atw-px-4 atw-pt-4"},(0,l.createElement)("div",{className:"atw-relative atw-flex atw-items-center atw-justify-center atw-border atw-border-solid atw-px-4 atw-border-gray-300 "+a,style:this.printBackground(r)},(0,l.createElement)("i",{className:"fa-solid fa-images atw-flex  atw-text-gray-400 atw-text-9xl atw-py-10",xstyle:{fontSize:"128px",paddingTop:"16px",fontStyle:"normal",marginTop:"16px"}}),v&&(0,l.createElement)("div",{className:this.printNavPos(d)+" atw-absolute atw-text-sm atw-px-3 atw-py-2 atw-mx-3 atw-my-3 atw-border atw-border-solid atw-bg-gray-100 atw-border-gray-300 atw-rounded"},(0,l.createElement)("span",{className:"fas fa-camera"}),(0,l.createElement)("span",{className:"atw-pl-2"},"1 / 4"))),u&&(0,l.createElement)("div",{className:"atw-flex atw-flex-row atw-mt-4"},[0,1,2,3].map((e=>(0,l.createElement)("div",{className:"atw-flex atw-items-center atw-justify-center atw-border atw-border-solid atw-mr-2 atw-border-gray-300 "+m+" "+g,style:this.printBackground(w)},(0,l.createElement)("i",{className:"atw-flex fa-solid fa-image atw-text-gray-400 atw-text-3xl"})))))),(0,l.createElement)("div",{class:"atw-block atw-bg-gray-100 atw-py-2 atw-rounded-b-lg atw-text-sm atw-text-center"},(0,l.createElement)("span",{class:"fas fa-warning atw-not-italic atw-text-gray-400 atw-mr-2"}),(0,l.createElement)("span",{class:"atw-text-xs atw-text-gray-600"},"This is a preview only, in the frontend you will see a gallery here."))))):(0,l.createElement)(l.Fragment,null,this.renderInit()))}}const m=u,g=JSON.parse('{"name":"wpadverts/single-gallery","textdomain":"wpadverts","apiVersion":1,"title":"Classifieds Single Gallery","icon":"megaphone","category":"wpadverts","example":{},"attributes":{"post_type":{"type":"string","default":""},"gallery_img_height":{"type":"string","default":"atw-h-72"},"gallery_img_size":{"type":"string","default":"full"},"gallery_fit":{"type":"string","default":"contain"},"gallery_bg":{"type":"string","default":""},"slider_is_lazy":{"type":"boolean","default":false},"thumb_show":{"type":"boolean","default":true},"thumb_width":{"type":"string","default":"atw-w-24"},"thumb_height":{"type":"string","default":"atw-h-16"},"thumb_img_size":{"type":"string","default":"adverts_list"},"thumb_fit":{"type":"string","default":"scale-down"},"thumb_bg":{"type":"string","default":""},"nav_show":{"type":"boolean","default":true},"nav_position":{"type":"string","default":"bottom-right"}}}');(0,e.registerBlockType)(g,{edit:m,save:({attributes:e})=>null})})();